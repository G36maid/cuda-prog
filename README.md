# Introduction to CUDA Parallel Programming Homework Assignments 2025

This document summarizes the CUDA homework assignments for the 2025 Introduction to CUDA Parallel Programming course. It is intended to provide a clear overview of each assignment and how to run them on the TWCP1 cluster.

# Usage on TWCP1 Cluster

To run your assignments on the twcp1 cluster:

1. Modify the provided job submission script (cmd).
2. Submit the job using:
  - condor_submit cmd
3. Monitor the job output using:
  - jview

## HW01

1. To write your own CPU+GPU code for the modified matrix addition as
defined by c(i,j) = 1/a(i,j) + 1/b(i,j). Setting the input NxN matrices A
and B (where N=6400) with entries of random numbers between 0.0
and 1.0, determine the optimal block size by running your code. You
can use the sample code
twqcp1:/home/cuda_lecture_2025/vecAdd_1GPU/vecAdd.cu as a
template to develop your own code.

## HW02

1. Write your own CPU+GPU code for finding the trace of a matrix of
real numbers with parallel reduction. You can use the sample code in
twcp1:/home/cuda_lecture_2025/vecDotProduct/vecDot.cu
as template. The input N x N matrix can be generated by the routine
RandomInit with N=6400. Also, determine the optimal block size and
grid size for this problem.

## HW03

1. Solve the Poisson equation on a 3D lattice with boundary conditions.
Consider a cube of size L x L x L with a point charge q=1 at its center
(L/2, L/2, L/2), with lattice sites (0, 1, 2, ..., L) in each direction, subject
to the boundary conditions with potential equal to zero on its entire
surface. Find the potential versus the distance r from the point
charge, for L=8, 16, 32, 64 respectively.
Does the potential approach the Coulomb’s law in the limit L >>1 ?

## HW04

1. Dot-product
Write your own CUDA code for finding the dot-product of 2 real
vectors with N-GPUs, which generalizes the 1-GPU code in
twcp1:/home/cuda_lecture_2025/vecDotProduct/vecDot.cu
Test your code with 2 GPUs, using random vectors of size 40960000
elements generated by the routine RandomInit. Also, determine the
optimal block size and grid size for this problem.

## HW05

1. Heat Diffusion
Using a Cartesian grid of 1024 x 1024, solve for the thermal
equilibrium temperature distribution on a square plate. The
temperature along the top edge of the plate is at 400 K, while the
remainder of the circumference is at 273 K. Write a CUDA code for
multi-GPUs to solve this problem. Test your code with one and two
GPUs. Also, to determine the optimal block size for this problem. The
value of  can be fixed to 1.

## HW06

1. Histogram of a data set with exponential distribution
Write a pseudo-random number generator to generate random
numbers in (0,) with the exponential distribution exp(-x), and use it
to generate a data set of 81920000 entries. Compare the histograms
computed by CPU, GPU with global memory, and GPU with shared
memory, as well as their speeds. Plot the histogram, together with the
curve of the theoretical probability distribution.
Also, to determine the optimal block sizes for this problem.

## HW07


1. Monte Carlo integration in 10-dimensions
Write a C/C++ program to perform the Monte Carlo integration of the 10-
dimensional integral

$$
I = \int_0^1 dx_1 \int_0^1 dx_2 \cdots \int_0^1 dx_{10} \, \frac{1}{1 + x_1^2 + x_2^2 + \cdots + x_{10}^2}
$$

with the following algorithms:
(a) Simple sampling.
(b) Importance sampling with the Metropolis algorithm, using the weight function

$$
W(x_1, x_2, \ldots, x_{10}) = w(x_1) w(x_2) \cdots w(x_{10}), \quad w(x) = Ce^{-a x}, \quad i = 1, \ldots, 10
$$


where the normalization constant C and the value of a are determined by yourself.
In each case, compute the mean and the standard deviation versus the number
of samplings

$$
N = 2^n, \quad n = 2, 3, \ldots, 16
$$

respectively.
Write CUDA code to perform this Monte Carlo integration with multi-GPUs. Test your
code with one and two GPUs, by comparing GPU and CPU results. You may start by
writing your CUDA code for one GPU.


## HW08

1. GPU accelerated Monte Carlo simulation of 2D Ising model on a torus
For one GPU, determine the optimal block size for MC simulation on the
200 × 200 lattice. Then use the optimal block size to perform MC simulations at
B=0, and T=2.0, 2.1, 2.2, 2.3, 2.4, and 2.5, and measure < E > and < M >, and
estimate their errors respectively. Summarize your results of < E >, δ < E >,
< M >, and δ < M > with tables, and plot them versus T.
2. CUDA C/C++ code for multi-GPUs
Write a CUDA C/C++ code for simulation of 2D Ising model on the torus with
multi-GPUs. Test your code with one and two GPUs, by comparing GPU and CPU
results.
3. Repeat 1. for the MC simulation with 2 GPUs

## HW09

1. Poisson equation on the 3-dimensional lattice
Consider a point charge at the origin of the 3-dimensional lattice with periodic
boundary condition in all directions. Use cuFFT to perform the inverse Fourier
transform from the momentum space to the position space, and obtain the
potential along the diagonal as well as the x-axis of the 32 x 32 x 32 lattice.
Then, to assert that your solution is indeed physically correct.
Next, to investigate what is the largest 3D lattice you can solve the Poisson
equation with one Nvidia GTX-1060.
